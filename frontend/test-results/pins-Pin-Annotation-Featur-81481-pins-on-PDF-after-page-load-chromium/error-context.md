# Page snapshot

```yaml
- generic [ref=e3]:
  - generic [ref=e4]:
    - textbox "Paste DOI or URL to import paper..." [ref=e5]
    - button "Import" [ref=e6] [cursor=pointer]
  - generic [ref=e7]:
    - generic [ref=e8]:
      - textbox "Filter papers..." [ref=e10]
      - generic [ref=e11]:
        - generic [ref=e12] [cursor=pointer]:
          - generic [ref=e13]: Efficient coding in biophysically realistic excitatory-inhibitory spiking networks
          - generic [ref=e14]: Veronika Koren et al. • 2025
        - generic [ref=e15] [cursor=pointer]:
          - generic [ref=e16]: Rhythmic Auditory Cortex Activity at Multiple Timescales Shapes Stimulus–Response Gain and Background Firing
          - generic [ref=e17]: Christoph Kayser et al. • 2015
        - generic [ref=e18] [cursor=pointer]:
          - generic [ref=e19]: Encoding of Naturalistic Stimuli by Local Field Potential Spectra in Networks of Excitatory and Inhibitory Neurons
          - generic [ref=e20]: Alberto Mazzoni et al. • 2008
    - generic [ref=e21]:
      - generic [ref=e23] [cursor=pointer]:
        - generic [ref=e24]: Efficient coding in biophysica...
        - generic [ref=e25]: ×
      - generic [ref=e26]:
        - generic [ref=e28]:
          - generic [ref=e31]: "Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 1 of 48 Efficient coding in biophysically realistic excitatory- inhibitory spiking networks Veronika Koren 1,2,3 *, Simone Blanco Malerba 1 , Tilo Schwalger 2,3 , Stefano Panzeri 1 * 1 Institute of Neural Information Processing, Center for Molecular Neurobiology (ZMNH), University Medical Center Hamburg- Eppendorf, Hamburg, Germany; 2 Institute of Mathematics, Technische Universität Berlin, Berlin, Germany; 3 Bernstein Center for Computational Neuroscience Berlin, Berlin, Germany eLife Assessment This study offers a valuable treatment of how the population of excitatory and inhibitory neurons integrates principles of energy efficiency in their coding strategies. The convincing analysis provides a comprehensive characterisation of the model, highlighting the structured connectivity between excitatory and inhibitory neurons. The role of the many free parameters are discussed and studied in depth. Abstract The principle of efficient coding posits that sensory cortical networks are designed to encode maximal sensory information with minimal metabolic cost. Despite the major influence of efficient coding in neuroscience, it has remained unclear whether fundamental empirical proper- ties of neural network activity can be explained solely based on this normative principle. Here, we derive the structural, coding, and biophysical properties of excitatory- inhibitory recurrent networks of spiking neurons that emerge directly from imposing that the network minimizes an instantaneous loss function and a time- averaged performance measure enacting efficient coding. We assumed that the network encodes a number of independent stimulus features varying with a time scale equal to the membrane time constant of excitatory and inhibitory neurons. The optimal network has biolog- ically plausible biophysical features, including realistic integrate- and- fire spiking dynamics, spike- triggered adaptation, and a non- specific excitatory external input. The excitatory- inhibitory recurrent connectivity between neurons with similar stimulus tuning implements feature- specific competition, similar to that recently found in visual cortex. Networks with unstructured connectivity cannot reach comparable levels of coding efficiency. The optimal ratio of excitatory vs inhibitory neurons and the ratio of mean inhibitory- to- inhibitory vs excitatory- to- inhibitory connectivity are comparable to those of cortical sensory networks. The efficient network solution exhibits an instantaneous balance between excitation and inhibition. The network can perform efficient coding even when external stimuli vary over multiple time scales. Together, these results suggest that key properties of biolog- ical neural networks may be accounted for by efficient coding. Introduction Information about the sensory world is represented in the brain through the dynamics of neural popu- lation activity ( Abbott et al., 2016 ; Thalmeier et al., 2016 ). One prominent theory about the princi- ples that may guide the design of neural computations for sensory function is efficient coding ( Barlow, 1961 ; Olshausen and Field, 1996 ; Deneve and Chalk, 2016a ). This theory posits that neural compu- tations are optimized to maximize the information that neural systems encode about sensory stimuli while at the same time limiting the metabolic cost of neural activity. Efficient coding has been highly R E s E a RCH aRTICLE *For correspondence: v.koren@uke.de (VK); s.panzeri@uke.de ( s P) Competing interest: The authors declare that no competing interests exist. Funding: See page 39 Preprint posted 27 April 2024 Sent for Review 28 May 2024 Reviewed preprint posted 26 July 2024 Reviewed preprint revised 22 January 2025 Reviewed preprint revised 30 January 2025 Version of Record published 07 March 2025 Reviewing Editor: Richard Naud, University of Ottawa, Canada Copyright Koren et al . This article is distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use and redistribution provided that the original author and source are credited."
          - generic [ref=e34]: "Research articl e Computational and systems Biology Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 2 of 48 influential as a normative theory of how networks are organized and designed to optimally process natural sensory stimuli in visual ( Atick, 1992 ; Olshausen and Field, 1997 ; Simoncelli and Olshausen, 2001 ; Vinje and Gallant, 2000 ; Olshausen and Field, 2004 ; Li, 2014 ), auditory ( Lewicki, 2002 ), and olfactory sensory pathways ( Koulakov and Rinberg, 2011 ). The first normative neural network models ( Olshausen and Field, 1996 ; Olshausen and Field, 2004 ) designed with efficient coding principles had at least two major levels of abstractions. First, neural dynamics was greatly simplified, ignoring the spiking nature of neural activity. Instead, biolog- ical networks often encode information through millisecond- precise spike timing ( Bialek et al., 1991 ; Bialek and Rieke, 1992 ; Panzeri et al., 2001 ; Nemenman et al., 2008 ; Kayser et al., 2010 ; Ince et al., 2013 ; Panzeri et al., 2010 ). Second, these earlier contributions mostly considered encoding of static sensory stimuli, whereas the sensory environment changes continuously at multiple timescales and the dynamics of neural networks encodes these temporal variations of the environment ( Fairhall et al., 2001 ; Wark et al., 2009 ; Mazzoni et al., 2008 ; Młynarski and Hermundstad, 2021 ). Recent years have witnessed a considerable effort and success in laying down the mathematical tools and methodology to understand how to formulate efficient coding theories of neural networks with more biological realism ( Koren et al., 2023 ). This effort has established the incorporation of recurrent connectivity ( Lochmann et al., 2012 ; Zhu and Rozell, 2013 ), of spiking neurons, and of time- varying stimulus inputs ( Boerlin et al., 2013 ; Bourdoukan et al., 2012 ; Moreno- Bote and Drugowitsch, 2015 ; Chalk et al., 2016 ; Deneve and Machens, 2016b ; Gutierrez and Denève, 2019 ; Kadmon et al., 2020 ; Rullán Buxó and Pillow, 2020 ). In these models, the efficient coding principle has been implemented by designing networks whose activity maximizes the encoding accu- racy, by minimizing the error between a desired representation and a linear readout of network’s activity, subject to a constraint on the metabolic cost of processing. This double objective is captured by a loss function that trades off encoding accuracy and metabolic cost. The minimization of the loss function is performed through a greedy approach, by assuming that a neuron will emit a spike only if this will decrease the loss. This, in turn, yields a set of leaky integrate- and- fire (LIF) neural equations ( Boerlin et al., 2013 ; Bourdoukan et al., 2012 ), which can also include biologically plausible non- instantaneous synaptic delays ( Koren and Denève, 2017 ; Rullán Buxó and Pillow, 2020 ; Kadmon et al., 2020 ). Although most initial implementations did not respect Dale’s law, further studies analyt- ically derived efficient networks of excitatory (E) and inhibitory (I) spiking neurons that respect Dale’s eLife digest The networks of nerve cells that make up the brain are complex and versatile. They enable the information processing necessary for both simple and complex thought processes. But, the organization of nerve networks in the brain is a topic of great debate among scientists. One idea is that nerve cell networks in the brain are organized to be as efficient as possible at transmitting information. Scientists supporting this idea say it allows the brain to send accurate infor- mation using as little energy as possible. Scientists have developed mathematical models to explain how this efficient coding model of brain activity works. But how accurately these mathematical models capture complex brain tasks is up for debate. Some question how well these models explain how the brain makes sense of sensory informa- tion like sights or smells. Are they able to explain nerve cell organization or how nerve cells react to new information or experiences? Scientists also question how well the mathematical models capture biological and physical constraints on nerve cell activity. To answer these questions, Koren et al. used mathematical models to systematically test whether the efficient coding model was consistent with what happens in realistic circumstances. The experiments show that mathematical models of efficient coding are consistent with actual brain cell behavior, orga- nization and interconnections. The models also reflected the cells’ biological and physical constraints. The experiments support the idea that brain networks are designed for efficiency. But the models used in the study are too simple to assess the full range and complexity of information processing in the brain. More studies are needed to test more complex mathematical models that better recreate more advanced brain activities. Further study of the biological and physical constraints on nerve cells in the brain may shed more light on how they behave in brain networks."
          - generic [ref=e37]: "Research articl e Computational and systems Biology Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 3 of 48 law ( Boerlin et al., 2013 ; Barrett et al., 2016 ; Chalk et al., 2016 ; Koren and Panzeri, 2022 ) and included spike- triggered adaptation ( Koren and Panzeri, 2022 ). These networks take the form of generalized leaky integrate- and- fire (gLIF) models neurons, which are realistic models of neuronal activity ( Brette and Gerstner, 2005 ; Mensi et al., 2012 ; Gerstner et al., 2014 ) and capable of accurately predicting real neural spike times in vivo ( Jolivet et al., 2008 ). Efficient spiking models thus have the potential to provide a normative theory of neural coding through spiking dynamics of E- I circuits ( Brendel et al., 2020 ; Koren and Panzeri, 2022 ; Podlaski and Machens, 2024 ) with high biological plausibility. However, despite the major progress described above, we still lack a thorough characterization of which structural, coding, biophysical and dynamical properties of excitatory- inhibitory recurrent spiking neural networks directly relate to efficient coding. Previous studies only rarely made predic- tions that could be quantitatively compared against experimentally measurable biological properties. As a consequence, we still do not know which, if any, fundamental properties of cortical networks emerge directly from efficient coding. To address the above questions, we systematically analyze our biologically plausible efficient coding model of E and I neurons that respects Dale’s law ( Koren and Panzeri, 2022 ). We make concrete predictions about experimentally measurable structural, coding and dynamical features of neurons that arise from efficient coding. We systematically investigate how experimentally measurable emergent dynamical properties, including firing rates, trial- to- trial spiking variability of single neurons and E- I balance ( Vogels et al., 2011 ), relate to network optimality. We further analyze how the orga- nization of the connectivity arising by imposing efficient coding relates to the anatomical and effec- tive connectivity recently reported in visual cortex, which suggests competition between excitatory neurons with similar stimulus tuning. We find that several key and robustly found empirical properties of cortical circuits match those of our efficient coding network. This lends support to the notion that efficient coding may be a design principle that has shaped the evolution of cortical circuits and that may be used to conceptually understand and interpret them. Results Assumptions and emergent structural properties of the efficient E-I network derived from first principles We study the properties of a spiking neural network in which the dynamics and structure of the network are analytically derived starting from first principles of efficient coding of sensory stimuli. The model relies on a number of assumptions, described next. The network responds to M time- varying features of a sensory stimulus, ⃗ s ( t ) = [ s 1 ( t ), . . . , s M ( t )] ⊤ (e.g. for a visual stimulus, contrast, orientation, etc.) received as inputs from an earlier sensory area. We model each feature s k ( t ) as an independent Ornstein–Uhlenbeck (OU) processes (see Materials and methods). The network’s objective is to compute a leaky integration of sensory features; the target representations of the network, ⃗ x ( t ) , is defined as ⃗ ˙ x ( t ) = − 1 τ ⃗ x ( t ) + ⃗ s ( t ), (1) with τ a characteristic integration time- scale ( Figure 1A(i) ). We assumed leaky integration of sensory features for consistency with previous theoretical models ( Barrett et al., 2016 ; Chalk et al., 2016 ; Gutierrez and Denève, 2019 ). This assumption stems from the finding that, in many cases, integra- tion of sensory evidence by neurons is well described by an exponential kernel ( Scott et al., 2017 ; Danskin et al., 2023 ). Additionally, a leaky integration of neural activity with an exponential kernel implemented in models of neural activity readout often explains well the perceptual discrimination results ( Gold and Shadlen, 2001 ; Usher and McClelland, 2001 ; Chong et al., 2020 ). This suggests that the assumption of leaky integration of sensory evidence, although possibly simplistic, captures relevant aspects of neural computations. The network is composed of two neural populations of excitatory (E) and inhibitory (I) neurons, defined by their postsynaptic action which respects Dale’s law. For each population, y ∈ { E , I } , we define a population readout of each feature, ⃗ ˆ x y ( t ) , as a filtered weighted sum of spiking activity of neurons in the population,"
          - generic [ref=e40]: "Research articl e Computational and systems Biology Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 4 of 48 Figure 1. Structural and dynamical properties of the efficient E- I spiking network. ( A, i ) Encoding of a target signal representing the evolution of a stimulus feature (top) with one E (middle) and one I spiking neuron (bottom). The target signal x ( t ) integrates the input signal s ( t ) . The readout of the E neuron tracks the target signal and the readout of the I neuron tracks the readout of the E neuron. Neurons spike to bring the readout of their activity Figure 1 continued on next page"
          - generic [ref=e43]: "Research articl e Computational and systems Biology Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 5 of 48 ⃗ ˙ ˆ x y ( t ) = − 1 τ⃗ ˆ x y ( t ) + N y ∑ i =1 ⃗ w y i f y i ( t ), (2) where f y i ( t ) is the spike train of neuron i of type y and ⃗ w y i = [ w y 1 i , . . . , w y Mi ] ⊤ is the vector of decoding weights of the neuron for features k = 1, ..., M ( Figure 1A(ii) ). We assume that every neuron encodes multiple ( M > 1 ) stimulus features and that the encoding of every stimulus is distributed among neurons. As a result of the optimization, the decoding weights of the neurons are equivalent to the neuron’s stimulus tuning parameters (see Materials and methods and Brendel et al., 2020 ). We sampled tuning parameters uniformly from a M - dimensional hypersphere with unit radius, giving tuning vectors with unit length to all neurons (see Materials and methods). To control the amount of inhibition in the network, we then multiplied the tuning vectors of I neurons with a factor d > 1 , homogeneously across all I neurons. Normalization of decoding vectors preserves the heterogeneity of decoding weights across neurons, which may benefit coding efficiency ( Zeldenrust et al., 2021 ). Following previous work ( Boerlin et al., 2013 ; Barrett et al., 2016 ; Chalk et al., 2016 ), we impose that E and I neurons have distinct normative objectives and we define specific loss functions relative to each neuron type. To implement at the same time, as requested by efficient coding, the constraints of faithful stimulus representation with limited computational resources ( Tavoni et al., 2019 ), we define the loss functions of the population y ∈ { E , I } as a weighted sum of a time- dependent encoding error and time- dependent metabolic cost: L y ( t ) = ϵ y ( t ) + βκ y ( t ), y ∈ { E , I }. (3) We refer to β , the parameter controlling the relative importance of the metabolic cost over the encoding error, as the metabolic constant of the network. We hypothesize that population readouts of E neurons, ⃗ ˆ x E ( t ) , track the target representations, ⃗ x ( t ) , and the population readouts of I neurons, ⃗ ˆ x I ( t ) , track the population readouts of E neurons, ⃗ ˆ x E ( t ) , by minimizing the squared error between these quantities ( Koren and Panzeri, 2022 ) (see also ( Boerlin et al., 2013 ; Denève et al., 2017 ) for related approaches). Furthermore, we hypothesize the metabolic cost to be proportional to the instantaneous estimate of network’s firing frequency. We thus define the variables of loss functions in Equation 3 as closer to their respective target. Each spike causes a jump of the readout, with the sign and the amplitude of the jump being determined by neuron’s tuning parameters. (ii) Schematic of the matrix of tuning parameters. Every neuron is selective to all stimulus features (columns of the matrix), and all neurons participate in encoding of every feature (rows). ( B, i ) Schematic of the network with E (red) and I (blue) cell type. E neurons are driven by the stimulus features while I neurons are driven by the activity of E neurons. E and I neurons are connected through recurrent connectivity matrices. (ii) Schematic of E (red) and I (blue) synaptic interactions. Arrows represent the direction of the tuning vector of each neuron. Only neurons with similar tuning are connected and the connection strength is proportional to the tuning similarity. ( C, i ) Schematic of similarity of tuning vectors (tuning similarity) in a 2- dimensional space of stimulus features. (ii) Synaptic strength as a function of tuning similarity. ( D ) Coding and dynamics in a simulation trial. Top three rows show the signal (black), the E estimate (red) and the I estimate (blue) for each of the three stimulus features. Below are the spike trains. In the bottom row, we show the average instantaneous firing rate (in Hz). ( E ) Top: Example of the target signal (black) and the E estimate in three simulation trials (colors) for one stimulus feature. Bottom: Distribution (across time) of the time- dependent bias of estimates in E and I cell type. ( F ) Left: Distribution of time- averaged firing rates in E (top) and I neurons (bottom). Black traces are fits with log- normal distribution. Right: Distribution of coefficients of variation of interspike intervals for E and I neurons. ( G ) Distribution (across neurons) of time- averaged synaptic inputs to E (left) and I neurons (right). In E neurons, the mean of distributions of inhibitory and of net synaptic inputs are very close. ( H ) Sum of synaptic inputs over time in a single E (top) and I neuron (bottom) in a simulation trial. ( I ) Distribution (across neurons) of Pearson’s correlation coefficients measuring the correlation of synaptic inputs A Ey and A Iy (as defined in Materials and methods, Equation 43 ) in single E (red) and I (blue) neurons. All statistical results ( E–F, H–I ) were computed on 10 simulation trials of 10 s duration. For model parameters, see Table 1 . The online version of this article includes the following figure supplement(s) for figure 1: Figure supplement 1. Efficient spiking model with one cell type and the encoding bias of the E- I network. Figure 1 continued"
          - generic [ref=e46]: "Research articl e Computational and systems Biology Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 6 of 48 ε E ( t ) = � � � ⃗ x ( t ) − ⃗ x E ( t ) � � � 2 , κ E ( t ) = N E ∑ i =1 [ r E i ( t ) ] 2 , ε I ( t ) = � � � ⃗ x E ( t ) − ⃗ x I ( t ) � � � 2 , κ I ( t ) = N I ∑ i =1 [ r I i ( t ) ] 2 , (4) where r y i , y ∈ { E , I } , is the low- pass filtered spike train of neuron i (single neuron readout) with time constant τ y r , proportional to the instantaneous firing rate of the neuron: z y i ( t ) = ( τ y r ) − 1 r y i ( t ) . We then impose the following condition for spiking: a neuron emits a spike at time t only if this decreases the loss function of its population ( Equation 3 ) in the immediate future. The condition for spiking also includes a noise term (Materials and methods) accounting for sources of stochasticity in spike gener- ation ( Faisal et al., 2008 ) which include the effect of non- specific inputs from the rest of the brain. We derived the dynamics and network structure of a spiking network that instantiates efficient coding ( Figure 1B , see Materials and methods). The derived dynamics of the subthreshold membrane potential V E i ( t ) and V I i ( t ) obey the equations of the generalized leaky integrate and fire (gLIF) neuron τ ˙ V y i ( t ) = − ( V y i ( t ) − V y rest ) + R m ( I syn, y i ( t ) − I ad, y i ( t ) + I ext, y i ( t ) ) , y ∈ { E , I }, (5) where I syn, y i , I ad, y i , and I ext, y i are synaptic current, spike- triggered adaptation current and non- specific external current, respectively, R m is the membrane resistance and V y rest is the resting potential. This dynamics is complemented with a fire- and- reset rule: when the membrane potential reaches the firing threshold ϑ y , a spike is fired and V y i ( t ) is set to the reset potential V reset, y i . The analytical solution in Equation 5 holds for any number of neurons (with at least 1 neuron in each population) and predicts an optimal spike pattern to encode the presented external stimulus. Following previous work ( Boerlin et al., 2013 ) in which physical units were assigned to derived mathematical expressions to interpret them as biophysical variables, we express computational variables (target stimuli in Equation 1 , popu- lation readouts in Equation 2 and the metabolic constant in Equation 3 ) with physical units in such a way that all terms of the biophysical model ( Equation 5 ) have realistic physical units. The synaptic currents in E neurons, I syn, E i , consist of feedforward currents, obtained as stimulus features ⃗ s ( t ) weighted by the tuning weights of the neuron, and of recurrent inhibitory currents ( Figure 1B ). Synaptic currents in I neurons, I syn, I i , consist of recurrent excitatory and inhibitory currents. Note that there are no recurrent connections between E neurons, a consequence of our assumption of no across- feature interaction in the leaky integration of stimulus features ( Equation 1 ). This assump- tion is likely to be simplistic even for early sensory cortices ( Emanuel et al., 2021 ). However, in other studies, we found that many properties of efficient networks implementing leaky integration hold also when input features are linearly mixed during integration ( Koren and Panzeri, 2022 ; Koren et al., 2023 ). The optimization of the loss function yielded structured recurrent connectivity ( Figure 1B(ii)– C ). Synaptic strength between two neurons is proportional to their tuning similarity, forming like- to- like connectivity, if the tuning similarity is positive; otherwise the synaptic weight is set to zero ( Figure 1C(ii) ) to ensure that Dale’s law is respected. A connectivity structure in which the synaptic weight is proportional to pairwise tuning similarity is consistent with some empirical observations in visual cortex ( Znamenskiy et al., 2024 ) and has been suggested by previous models ( Boerlin et al., 2013 ; Sadeh and Clopath, 2020 ). Such connectivity organization is also suggested by across- neuron influence measured with optogenetic perturbations of visual cortex ( Chettih and Harvey, 2019 ; Oldenburg et al., 2024 ). While such connectivity structure is the result of optimization, the rectifi- cation of the connectivity that enforces Dale’s law does not emerge from imposing efficient coding, but from constraining the space of solutions to biologically plausible networks. Rectification also sets the overall connection probability to 0.5, which is consistent with empirically observed connection probability from pyramidal (E) neurons to parvalbumin- positive (I) neurons ( Pala and Petersen, 2015 ; Campagnola et al., 2022 ), but likely overestimates the connection probability from parvalbumin- positive neurons to pyramidal neurons, which tends to be lower ( Campagnola et al., 2022 ). (For a study of how efficient coding would be implemented if the above Dale’s law constraint were removed and each neuron were free to have either an inhibitory or excitatory effect depending on the postsyn- aptic target, see Appendix 1 and Figure 1—figure supplement 1A–E )."
          - generic [ref=e49]: "Research articl e Computational and systems Biology Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 7 of 48 The spike- triggered adaptation current of neuron i in population y , I ad, y i , is proportional to its low- pass filtered spike train. This current realizes spike- frequency adaptation or facilitation depending on the difference between the time constants of population and single neuron readout (see Results subsection ‘Weak or no spike- triggered adaptation optimizes network efficiency’). Finally, non- specific external currents I ext, y i ( t ) have a constant mean that depends on the parameter β , and fluctuations that arise from the noise with strength σ in the condition for spiking. The relative weight of the metabolic cost over the encoding error, β , controls how the network responds to feed- forward stimuli, by modulating the mean of the non- specific synaptic currents incoming to all neurons. Together with the noise strength σ , these two parameters set the non- specific synaptic currents to single neurons that are homogeneous across the network and akin to the background synaptic input discussed in Destexhe et al., 2003 . By allowing a large part of the distance between the resting potential and the threshold to be taken by the non- specific current, we found a biologically plausible set of optimally efficient model parameters ( Table 1 ) including the firing threshold at about 20 mV from the resting potential, which is within the experimental ballpark ( Constantinople and Bruno, Table 1. Table of default model parameters for the efficient E- I network. Parameters above the double horizontal line are the minimal set of parameters needed to simulate model equations ( Equation 29a - 29h in Materials and methods). Parameters below the double horizontal line are biophysical parameters, derived from the same model equations and from model parameters listed above the horizontal line. Parameters N E , M , τ and σ E w were chosen for their biological plausibility and computational simplicity. Parameters N I , τ E r , τ I r , σ , ratio of mean E- I to I- I synaptic connectivity and β are parameters that maximize network efficiency (see the section ‘Criterion for determining model parameters’ in Materials and methods). The metabolic constant β and the noise strength σ are interpreted as global network parameters and are for this reason assumed to be the same across the E and I population, e.g., β E = β I = β and σ E = σ I = σ (see Equation 3 ). The connection probability of p xy = 0.5 is the consequence of rectification of the connectivity (see Equation 24 in Materials and methods). Parameter Notation Value Number of E neurons N E 400 Ratio of E to I neuron numbers N E : N I 4:1 Number of the input features M 3 Time constant of the population readout (E and I) τ 10ms Time constant of the single neuron readout τ E r = τ I r 10ms Noise strength (non- specific current) σ 5.0 mV Heterogeneity factor of tuning parameters in E σ E w 1.0 (mV) 1/2 Ratio of mean I- I to E- I synaptic connectivity mean I- I: mean E- I 3:1 Metabolic constant β 14 mV Threshold constant c /2 18 mV Distance threshold to reset potential (E neurons) | ϑ E − V E rest | 19 mV Distance threshold to reset potential (I neurons) | ϑ I − V I rest | 21 mV Connection probability (recurrent synapses) p IE = p II = p EI 0.5 Mean E- I synaptic weight (EPSP to I at max) ⟨ J IE ij ⟩ 0.75 mV Mean I- E synaptic weight (IPSP to E at max) ⟨ J EI ij ⟩ 0.75 mV Mean I- I synaptic weight (IPSP at max) ⟨ J II ij ⟩ 2.25 mV"
          - generic [ref=e52]: "Research articl e Computational and systems Biology Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 8 of 48 2013 ), and average synaptic strengths of 0.75 mV (E- I and I- E synapses) and 2.25 mV (I- I synapses), which are consistent with measurements in sensory cortex ( Campagnola et al., 2022 ). An optimal network without non- specific currents can be derived (see Materials and methods, Equation 25 ), but its parameters are not consistent with biology (see Appendix 2). The non- specific currents can be interpreted as synaptic currents that are modulated by larger- scale variables, such as brain states (see subsection ‘Non- specific currents regulate network coding properties’). To summarize, the analytical derivation of an optimally efficient network includes gLIF neurons ( Burkitt, 2006 ; Jolivet et al., 2008 ; Gerstner et al., 2014 ; Schwalger et al., 2017 ; Harkin et al., 2021 ), a distributed code with linear mixed selectivity to the input stimuli ( Chang and Tsao, 2017 ; Kaufman et al., 2014 ), spike- triggered adaptation, structured synaptic connectivity, and a non- specific external current akin to background synaptic input. Encoding performance and neural dynamics in an optimally efficient E-I network The equations for the E- I network of gLIF neurons in Equation 5 optimize the loss functions at any given time and for any set of parameters. In particular, the network equations have the same analytical form for any positive value of the metabolic constant β . To find a set of parameters that optimizes the overall performance, we minimized the loss function averaged over time and trials. We then optimized the parameters by setting the metabolic constant β such that the encoding error weights 70% and the metabolic error weights 30% of the average loss, and by choosing all other parameters such as to minimize numerically the average loss (see Materials and methods). The numerical optimization was performed by simulating a model of 400 E and 100 I units, a network size relevant for computations within one layer of a cortical microcolumn ( Lefort et al., 2009 ). The set of model parameters that optimized network efficiency is detailed in Table 1 . Unless otherwise stated, we will use the optimal parameters of Table 1 in all simulations and only vary parameters detailed in the figure axes. With optimally efficient parameters, population readouts closely tracked the target signals ( Figure 1D , M=3, R 2 = [0.95, 0.97] for E and I neurons, respectively). When stimulated by our three- dimensional time- varying feedforward input, the optimal E- I network provided a precise estimator of target signals ( Figure 1E , top). The average estimation bias ( B E and B I , see Materials and methods) of the network minimizing the encoding error was close to zero ( B E = 0.02 and B I = 0.03) while the bias of the network minimizing the average loss (and optimizing efficiency) was slightly larger and negative ( B E = –0.15 and B I = −0.34), but still small compared to the stimulus amplitude ( Figure 1E , bottom, Figure 1—figure supplement 1F ). Time- and trial- averaged encoding error (RMSE) and metabolic cost (MC, see Materials and methods) were comparable in magnitude ( RMSE = [3.5, 2.4] , MC = [4.4, 2.8] for E and I), but with smaller error and lower cost in I, leading to a better performance in I (average loss of 2.5) compared to E neurons (average loss of 3.7). We report both the encoding error and the metabolic cost throughout the paper, so that readers can evaluate how these perfor- mance measures may generalize when weighting differently the error and the metabolic cost. Next, we examined the emergent dynamical properties of an optimally efficient E- I network. I neurons had higher average firing rates compared to E neurons, consistently with observations in cortex ( Neske et al., 2015 ). The distribution of firing rates was well described by a log- normal distri- bution ( Figure 1F , left), consistent with distributions of cortical firing observed empirically ( Buzsáki and Mizuseki, 2014 ). Neurons fired irregularly, with mean coefficient of variation (CV) slightly smaller than 1 ( Figure 1F , right; CV = [0.97, 0.95] for E and I neurons, respectively), compatible with cortical firing ( Softky and Koch, 1993 ). We assessed E- I balance in single neurons through two complemen- tary measures. First, we calculated the average (global) balance of E- I currents by taking the time- average of the net sum of synaptic inputs (shortened to net synaptic input, see Ahmadian and Miller, 2021 ). Second, we computed the instantaneous ( Okun and Lampl, 2008 ; also termed detailed in Vogels et al., 2011 ) E- I balance as the Pearson correlation ( ρ ) over time of E and I currents received by each neuron (see Materials and methods). We observed an excess inhibition in both E and I neurons, with a negative net synaptic input in both E and I cells ( Figure 1H ), indicating an inhibition- dominated network according to the criterion of average balance ( Ahmadian and Miller, 2021 ). In E neurons, net synaptic current is the sum of the feedforward current and recurrent inhibition and the mean of the net current is close to the mean of the inhibitory current, because feedforward inputs have vanishing mean. Furthermore, we found a"
          - generic [ref=e55]: "Research articl e Computational and systems Biology Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 9 of 48 moderate instantaneous balance ( Xue et al., 2014 ), stronger in I compared to E cell type ( Figure 1G, I , ρ = [0.44, 0.25] , for I and E neurons, respectively), similar to levels measured empirically in rat visual cortex ( Tan et al., 2013 ). We determined optimal model parameters by optimizing one parameter at a time. To inde- pendently validate the so obtained optimal parameter set (reported in Table 1 ), we varied all six model parameters explored in the paper with Monte- Carlo random joint sampling (10,000 random samples), uniformly within a biologically plausible parameter range for each parameter ( Table 2 ). We did not find any parameter configuration with lower average loss than the setting in Table 1 ( Figure 2A–B ) when using the weighting of the encoding error with metabolic cost between 0.4 < g L < 0.81 ( Figure 2C ). The three parameter settings that came the closest to our configuration on Table 1 had stronger noise but also stronger metabolic constant than our configuration ( Table 3 ). The second, third and fourth configurations had longer time constants of both E and I single neurons. Ratios of E- I neuron numbers and of I- I to E- I connectivity in the second, third, and fourth best configuration were either jointly increased or decreased with respect to our optimal configuration. This suggests that joint covariations in parameters may influence the network’s optimality. While our finite Monte- Carlo random sampling does not fully prove the global optimality of the configuration in Table 1 , it shows that it is highly efficient. Competition across neurons with similar stimulus tuning emerging in efficient spiking networks We next explored coding properties emerging from recurrent synaptic interactions between E and I populations in the optimally efficient networks. An approach that has recently provided empirical insight into local recurrent interactions is measuring effective connectivity with cellular resolution. Recent effective connectivity experiments photostimulated single E neurons in primary visual cortex and measured its effect on neighbouring neurons, finding that the photostimulation of an E neuron led to a decrease in firing rate of simi- larly tuned close- by neurons ( Chettih and Harvey, 2019 ). This effective lateral inhibition ( Lochmann Table 2. Table of parameter ranges for Monte- Carlo sampling. Minimum and maximum of the uniform distributions from which we randomly drew parameters during Monte- Carlo random sampling. Parameter τ E r τ I r β σ N E : N I mean I- I: mean E- I minimum 5 ms 5 ms 2 mV 1 mV 1 1 maximum 50 ms 50 ms 29 mV 10 mV 8 8 Figure 2. Monte- Carlo joint random sampling on six model parameters. ( A ) Distribution of the trial- averaged loss, with weighting g L = 0.7, from 10,000 random simulations and using 20 simulation trials of duration of 1 s for each parameter configuration. The red cross marks the average loss of the parameter setting in Table 1 . Inset: The average loss of the parameter setting in Table 1 (red cross) and of the first- and second- best parameter settings from the random search. ( B ) Distribution of the average loss across 20 simulation trials for the parameter setting in Table 1 (red) and for the first four ranked points according to the trial- averaged loss in A. Stars indicate a significant two- tailed t- test against the distribution in red (*** indicate p < 0.001 ). ( C ) Same as in A, for different values of weighting of the error with the cost g L . Parameters for all plots are in Table 1 ."
          - generic [ref=e58]: "Research articl e Computational and systems Biology Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 10 of 48 et al., 2012 ) between E neurons with similar tuning to the stimulus implements competition between neurons for the representation of stimulus features ( Chettih and Harvey, 2019 ). Since our model instantiates efficient coding by design and because we removed connections between neurons with different selectivity, we expected that our network implements lateral inhibition and would thus give comparable effective connectivity results in simulated photostimulation experiments. To test this prediction, we simulated photostimulation experiments in our optimally efficient network. We first performed experiments in the absence of the feedforward input to ensure all effects are only due to the recurrent processing. We stimulated a randomly selected single target E neuron and measured the change in the instantaneous firing rate from the baseline firing rate, ∆ z i ( t ) , in all the other I and E neurons ( Figure 3A , left). The photostimulation was modeled as an application of a constant depolarising current with a strength parameter, a p , proportional to the distance between the resting potential and the firing threshold ( a p = 0 means no stimulation, while a p = 1 indicates photo- stimulation at the firing threshold). We quantified the effect of the simulated photostimulation of a target E neuron on other E and I neurons, distinguishing neurons with either similar or different tuning with respect to the target neuron ( Figure 3A , right; Figure 3—figure supplement 1A–D ). The photostimulation of the target E neuron increased the instantaneous firing rate of similarly- tuned I neurons and reduced that of other similarly- tuned E neurons ( Figure 3B ). We quantified the effective connectivity as the difference between the time- averaged firing rate of the recorded cell in presence or absence of the photostimulation of the targeted cell, measured during perturbation and up to 50 ms after. We found positive effective connectivity on I and negative effective connectivity on E neurons with similar tuning to the target neuron, with a positive correlation between tuning similarity and effective connectivity on I neurons and a negative correlation on E neurons ( Figure 3C ). We confirmed these effects of photostimulation in presence of a weak feedforward input ( Figure 3— figure supplement 1E ), similar to the experiments of Chettih and Harvey, 2019 in which photostim- ulation was applied during the presentation of visual stimuli with weak contrast. Thus, the optimal network replicates the preponderance of negative effective connectivity between E neurons and the dependence of its strength on tuning similarity found in Chettih and Harvey, 2019 . In summary, lateral excitation of I neurons and lateral inhibition of E neurons with similar tuning is an emerging coding property of the efficient E- I network, which recapitulates competition between neurons with similar stimulus tuning found in visual cortex ( Chettih and Harvey, 2019 ; Oldenburg et al., 2024 ). An intuition of why this competition implements efficient coding is that the E neuron that fires first activates I neurons with similar tuning. In turn, these I neurons inhibit all similarly tuned E neurons ( Figure 3A , right), preventing them to generate redundant spikes to encode the sensory information that has already been encoded by the first spike. Suppression of redundant spiking reduces metabolic cost without reducing encoded information ( Boerlin et al., 2013 ; Koren and Denève, 2017 ). While perturbing the activity of E neurons in our model qualitatively reproduces empirically observed lateral inhibition among E neurons ( Chettih and Harvey, 2019 ; Oldenburg et al., 2024 ), these experiments have also reported positive effective connectivity between E neurons with very similar stimulus tuning. Our intuition is that our simple model cannot reproduce this finding because it lacks E- E connectivity. Table 3. Table of best four parameter settings from Monte- Carlo sampling. The performance was evaluated using trial- and time- averaged loss. Each parameter setting was evaluated on 20 trials, with each trial using an independent realization of tuning parameters, noise in the non- specific current and initial conditions for the integration of the membrane potentials. We tested 10,000 parameter settings. Parameter τ E r τ I r β σ N E : N I mean I- I: mean E- I First 12.6 11.1 2.1 4.7 5.4 3.0 Second 11.4 10.0 2.9 6.2 6.1 3.3 Third 10.0 10.7 10.1 3.0 3.2 2.5 Fourth 12.5 13.5 2.9 5.4 4.9 3.5"
          - generic [ref=e61]: "Research articl e Computational and systems Biology Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 11 of 48 Figure 3. Mechanism of lateral excitation/inhibition in the efficient spiking network. ( A ) Left: Schematic of the E- I network and of the stimulation and measurement in a perturbation experiment. Right: Schematic of the propagation of the neural activity between E and I neurons with similar tuning. ( B ) Trial and neuron- averaged deviation of the firing rate from the baseline, for the population of I (top) and E (bottom) neurons with similar (magenta) and different tuning (gray) to the target neuron. Traces show the mean ± standard error of the mean, with the standard error of the mean on the variability across neurons and across trials. The stimulation strength corresponded to an increase in the firing rate of the stimulated neuron by 28.0 Hz. ( C ) Scatter plot of the tuning similarity vs. effective connectivity to the target neuron. Red line marks zero effective connectivity and magenta line is the least- squares line. Stimulation strength was a p = 1 . ( D ) Correlation of membrane potentials vs. the tuning similarity in E (top) and I cell type (bottom), for the efficient E- I network (left), for the network where each E neuron receives independent instead of shared stimulus features (middle), and for the network with unstructured connectivity (right). In the model with unstructured connectivity, elements of each connectivity matrix were randomly shuffled. We quantified voltage correlation using the (zero- lag) Pearson’s correlation coefficient, denoted as ρ ( V y i ( t ), V y j ( t )) , for each pair of neurons. ( E ) Average cross- correlogram (CCG) of spike timing with strongly similar (orange), weakly similar (green) and different tuning (black). Statistical results ( B–E ) were computed on 100 simulation trials. The duration of the trial in D- E was 1 s. Parameters for all plots are in Table 1 . The online version of this article includes the following figure supplement(s) for figure 3: Figure supplement 1. Tuning similarity and its relation to lateral excitation/inhibition."
          - generic [ref=e64]: "Research articl e Computational and systems Biology Koren et al . eLife 2024;13:RP99545. DOI: https:// doi. org/ 10. 7554/ eLife. 99545 12 of 48 To explore further the consequences of E- I interactions for stimulus encoding, we next investigated the dynamics of lateral inhibition in the optimal network driven by the feedforward sensory input but without perturbing the neural activity. Previous work has established that efficient spiking neurons may present strong correlations in the membrane potentials, but only weak correlations in the spiking output, because redundant spikes are prevented by lateral inhibition ( Boerlin et al., 2013 ; Deneve and Machens, 2016b ). We investigated voltage correlations in pairs of neurons within our network as a function of their tuning similarity. Because the feedforward inputs are shared across E neurons and weighted by their tuning parameters, they cause strong positive voltage correlations between E- E neuronal pairs with very similar tuning and strong negative correlations between pairs with very different (opposite) tuning ( Figure 3D , top- left). Voltage correlations between E- E pairs vanished regardless of tuning similarity when we made the feedforward inputs independent across neurons ( Figure 3D , top- middle), showing that the dependence of voltage correlations on tuning similarity occurs because of shared feedforward inputs. In contrast to E neurons, I neurons do not receive feed- forward inputs and are driven only by similarly tuned E neurons ( Figure 3A , right). This causes positive voltage correlations in I- I neuronal pairs with similar tuning and vanishing correlations in neurons with different tuning ( Figure 3D , bottom- left). Such dependence of voltage correlations on tuning similarity disappears when removing the structure from the E- I synaptic connectivity ( Figure 3D , bottom- right). In contrast to voltage correlations, and as expected by previous studies ( Boerlin et al., 2013 ; Deneve and Machens, 2016b ), the coordination of spike timing of pairs of E neurons (measured with cross- correlograms or CCGs) was very weak ( Figure 3E ). For I- I and E- I neuronal pairs, the peaks of CCGs were stronger than those observed in E- E pairs, but they were present only at very short lags (lags < 1 ms). This confirms that recurrent interactions of the efficient E- I network wipe away the effect of membrane potential correlations at the spiking output level, and shows information processing with millisecond precision in these networks ( Boerlin et al., 2013 ; Deneve and Machens, 2016b ; Koren and Denève, 2017 ). The effect of structured connectivity on coding efficiency and neural dynamics The analytical solution of the optimally efficient E- I network predicts that recurrent synaptic weights are proportional to the tuning similarity between neurons. We next investigated the role of such connectivity structure by comparing the behavior of an efficient network with an unstructured E- I network, similar to the type studied in previous works ( Brunel, 2000 ; Renart et al., 2010 ; Mazzoni et al., 2008 ). We removed the connectivity structure by randomly permuting synaptic weights across neuronal pairs (see Materials and methods). Such shuffling destroys the relationship between tuning similarity and synaptic strength (as shown in Figure 1C(ii) ) while it preserves Dale’s law and the overall distribution of connectivity weights. We found that shuffling the connectivity structure significantly altered the efficiency of the network ( Figure 4A, B ), neural dynamics ( Figure 4C, D, F–H ) and lateral inhibition ( Figure 4I ). In partic- ular, structured networks differ from unstructured ones by showing better encoding performance ( Figure 4A ), lower metabolic cost ( Figure 4B ), weaker variance of the membrane potential over time ( Figure 4C ), lower firing rates ( Figure 4D ) and weaker average ( Figure 4F ) and instantaneous balance ( Figure 4G ) of synaptic inputs. However, we found only a small difference in the variability of spiking between structured and unstructured networks ( Figure 4E ). While these results are difficult to test experimentally due to the difficulty of manipulating synaptic connectivity structures in vivo, they high- light the importance of the connectivity structure for cortical computations. We also compared structured and unstructured networks about their relation between pairwise voltage correlations and tuning similarity, by randomizing connections within a single connectivity type (E- I, I- I or I- E) or within all these three connectivity types at once (‘all’). We found the structure of E- I connectivity to be crucial for the linear relation between voltage correlations and tuning similarity in pairs of I neurons ( Figure 4H , magenta). Finally, we analyzed how the structure in recurrent connectivity influences lateral inhibition that we observed in efficient networks. We found that the dependence of lateral inhibition on tuning similarity vanishes when the connectivity structure is fully removed ( Figure 4I , ‘all’ on the right plot), thus showing that connectivity structure is necessary for lateral inhibition. While networks with unstructured E- I and I- E connectivity still show inhibition in E neurons upon single neuron photostimulation (because of the"
        - generic [ref=e66] [cursor=pointer]:
          - generic [ref=e67]: 7 pins
          - generic [ref=e68]: ▲
  - generic [ref=e69]:
    - generic [ref=e70]: 3 papers
    - generic [ref=e71]: 7 pins
```